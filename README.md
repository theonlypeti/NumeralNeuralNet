# Numeral Recognition Neural Network

This is a simple neural network that recognizes numerals from 0 to 9. The neural network is implemented in Python using the Keras library.

## Project Structure

The project contains the following files:

- `draw.py`: Script to convert black-on-white PNG images to datasets.
    - `output.csv`: CSV file containing the numeral data.
- `nn.ipynb`: Script to train the neural network. The input will be the csv generated by `draw.csv`.


- `render.py`: Script to generate images of numerals with metadata tags.
  - `outputdir/`: Directory where the generated images will be saved.
  

- `utils/prune_empty.py`: Utility script to prune empty rows from the CSV file.
- `utils/visual_prune.py`: Utility script to prune images by manual visual inspection.
- `utils/mylogger.py`: Utility script to log debug info.

## draw.py

The `draw.py` script is responsible for converting black-on-white PNG images into datasets. It uses the `watchdog` library to monitor changes in a specified directory and processes any modified images. The script splits each image into tiles and determines if each tile contains enough black pixels to be considered a "1" in the output dataset.

#### Key Features

- **File Watching**: Monitors a directory for changes and processes any modified images.
- **Image Processing**: Converts images into a dataset of 1s and 0s based on the presence of black pixels.
- **Visualization**: Optionally visualizes the grid and found black pixels for demonstration purposes.

### Usage

1. **Run the Script**: Start the script and specify the directory to watch for changes.

    ```bash
    python draw.py --directory /path/to/directory
    ```

2. **Edit Images**: Open any file named `n_input.png` (where `n` is the numeral), edit it, and save it. The script will convert the drawing to an array of 1s and 0s.

3. **View Output**: The processed data will be appended to `output.csv`.

#### Command Line Arguments

- `--debug`: Enable debug prints. Verbose!
- `--logfile`: Turns on logging to a text file.
- `--visualize`: Shows a grid with found black pixels after each file modification.
- `--directory`: Specifies the directory to look for changes in. Default is the current working directory.
- `--w`: Width of new images if they have not been created. Default is 400.
- `--h`: Height of new images if they have not been created. Default is 700.
- `--resolution`: Size of each tile. The output matrix is size/resolution. Default is 100.

## count_data.py

Use this script to analyze the numeral data stored in output.csv. The script counts the occurrences of each numeral sorted by the number of occurrences, showing the distribution of numerals in the dataset.


## render.py

The `render.py` script is responsible for generating images of numerals based on the data in `output.csv`. It reads the numeral data, creates images with the specified dimensions, and draws the numerals as black rectangles on a white background. Each image is saved with a metadata tag that includes the numeral label. The images are stored in the `outputdir` directory.



## utils/visual_prune.py

The `visual_prune.py` script helps in manually pruning the dataset by allowing users to visually inspect the generated images and remove any that are deemed unsuitable. It checks for missing images in the `outputdir` directory and removes the corresponding rows from the dataset. This script is useful for ensuring that the dataset only contains high-quality images that will improve the performance of the neural network.

## utils/prune_empty.py

The `prune_empty.py` script is a utility for cleaning the dataset by removing rows that contain only zeros. It reads the data from `output.csv`, filters out the empty rows, and writes the cleaned data back to the CSV file. This ensures that the dataset used for training the neural network is free of irrelevant or empty entries. This script usually runs each time the dataset is accessed, so you don't need to run it manually.

## utils/mylogger.py

The `mylogger.py` script provides a custom logging setup for the project, enhancing the standard Python logging module with additional features. It supports custom log levels and colored log messages. The coloredlogs library's logger is modified to highlight the numerical data that's detected by `draw.py`. Use `logger.info("message")` or `.debug()` `.warning()` `.error()` etc.

## nn.ipynb

The `nn.ipynb` script is a Jupyter notebook that trains a neural network to recognize numerals from 0 to 9. It reads the data from `output.csv`, preprocesses it, and trains a neural network using the Keras library. The notebook includes detailed explanations of each step in the process, making it easy to understand and modify the code as needed.

## Installation

Optimally, create a virtual environment for the project like conda.
To install the required packages, run:

```bash
pip install -r requirements.txt
```

